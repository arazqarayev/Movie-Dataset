"""
Movies Dataset Analysis
-----------------------
This script performs a basic exploratory data analysis (EDA) on a movie dataset.
It includes data cleaning, type conversion, missing value inspection,
and correlation analysis between key numerical features.

Author: Araz Garayev
Date: 2025-11-05
"""

# === 1. Importing Libraries ===
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib
import matplotlib.pyplot as plt

# Set global plot style
plt.style.use('ggplot')
matplotlib.rcParams['figure.figsize'] = (12, 8)

# === 2. Load Dataset ===
df = pd.read_csv(r'C:\Users\User\OneDrive\Desktop\data\movies.csv')

print("‚úÖ First 5 rows of dataset:")
print(df.head(), "\n")

print("üìä Dataset Info:")
print(df.info(), "\n")

# === 3. Missing Values Check ===
print("üîç Missing Value Percentage by Column:")
for col in df.columns:
    pct_missing = np.mean(df[col].isnull())
    print(f"{col} - {pct_missing:.2%}")

# === 4. Data Types Overview ===
print("\nüß© Data Types:")
print(df.dtypes)

# === 5. Cleaning & Type Conversion ===
# Fill missing budget/gross values with 0 and ensure integer type
df['budget'] = df['budget'].fillna(0).astype('int64')
df['gross']  = df['gross'].fillna(0).astype('int64')

print("\nüìà After Type Conversion:")
print(df.dtypes[['budget', 'gross']])
print(df.head(3), "\n")

# === 6. Create Correct Year Column ===
# Extracts the first 4 characters from 'released' column to get the release year
df['year_correct'] = df['released'].astype(str).str[:4]

# === 7. Sort Movies by Gross Income ===
df_sorted = df.sort_values(by='gross', ascending=False)
pd.set_option('display.max_rows', None)

# === 8. Explore Unique Companies ===
unique_companies = df['company'].drop_duplicates().sort_values(ascending=False)
print("üè¢ Number of unique production companies:", len(unique_companies))

# === 9. Correlation Analysis ===
corr_matrix = df.corr(method='pearson', numeric_only=True)

print("\nüìä Pearson Correlation Matrix (Numeric Columns):")
print(corr_matrix)

# === 10. Visualize Correlations ===
sns.heatmap(corr_matrix, annot=True, cmap="coolwarm")
plt.title('Correlation Matrix for Numeric Features')
plt.xlabel('Movie Features')
plt.ylabel('Movie Features')
plt.tight_layout()
plt.show()
