"""
Movies EDA â€“ Cleaning & Correlation
Author: Araz Garayev
"""

# 1) Libraries & Style
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib
import matplotlib.pyplot as plt

plt.style.use('ggplot')
matplotlib.rcParams['figure.figsize'] = (12, 8)

# 2) Load data
# Not: Jupyter'deysen %matplotlib inline kullanabilirsin; .py dosyasÄ±nda gerek yok.
df = pd.read_csv(r'C:\Users\User\OneDrive\Desktop\data\movies.csv')
print("First rows:\n", df.head(), "\n")

# 3) Missing value report
print("ğŸ” Missing Value Percentage by Column:")
for col in df.columns:
    pct_missing = np.mean(df[col].isnull())
    print(f"{col} - {pct_missing:.2%}")

# 4) Drop rows with NaN in critical columns (keep dataset quality)
critical_cols = ['rating','gross','released','score','votes','writer','star','company','runtime','country']
df = df.dropna(subset=critical_cols)

# 5) Budget: fill 26% missing with median (robust to outliers)
print("\nBudget dtype before cleaning:", df['budget'].dtypes)
# EÄŸer budget object ise sayÄ±ya Ã§evir:
df['budget'] = pd.to_numeric(df['budget'], errors='coerce')
df['budget'] = df['budget'].fillna(df['budget'].median())

print("\nğŸ“ˆ After Cleaning & Type Check (budget, gross):")
print(df.dtypes[['budget', 'gross']])
print
